# ROS2 初学者二级课程
## 课程最终项目 - 说明

是时候开始这门课程的最终项目了！

在这个项目中，你将在我们一起构建的移动底座上添加一个小型机械臂（只有2个轴，保持简单）。这将让你练习在这门课程中看到的一切。

在开始之前，请确保观看介绍视频，了解最终结果的概况。

然后，在这个PDF中，你可以找到机械臂的规格说明，以及一些帮助你入门的提示。

**注意1：** 最终结果是在移动底座上的简单机械臂，由一个相当简单的gazebo plugin控制。所以机械臂不会做任何花哨的事情，但这不是这里的目标。目标是练习我们在这门课程中看到的内容，并为你接下来可以做的事情打开可能性。然后在课程结束后，如果你愿意，可以学习更多关于机械臂控制的知识，例如使用ROS Moveit2框架。

**注意2：** 进步的最佳方式是投入一些时间和精力独自完成项目。如果你在没有帮助的情况下无法完成也没关系，因为这比我之前给你的挑战稍微困难一些。但你尝试得越多，学到的就越多。然后，如果你独自完成了项目，我仍然建议你观看解决方案，这样你就可以比较，也可以看到我是如何做的，并获得一些最佳实践。

## 规格说明

以下是你需要创建机器人的规格。注意我没有提供所有可能的值，只是你开始所需的值。根据这些，你可以计算剩余的值，或者（对于gazebo plugins）通过在互联网上搜索找到更多信息。

### URDF Links：

**arm_base_link：**
- Box：尺寸 0.1 0.1 0.02
- 颜色：橙色
- 质量：0.5

**forearm_link：**
- Cylinder：半径 0.02 长度 0.3
- 颜色：黄色
- 质量：0.3

**hand_link：**
- Cylinder：半径 0.02，长度 0.3
- 颜色：橙色
- 质量：0.3

### URDF Joints：

**arm base和forearm之间：**
- 类型：revolute
- 限制：下限 0，上限 pi/2，力矩 100，速度 100
- 添加一些摩擦力：`<dynamics friction="0.3" damping="0.3" />`

**forearm和hand之间：**
- 类型：revolute
- 限制：下限 0，上限 pi/2，力矩 100，速度 100
- 添加一些摩擦力：`<dynamics friction="0.3" damping="0.3" />`

### Gazebo plugins 所需字段：

**JointStatePublisher**
- joint_name：机械臂中每个关节一个

**JointPositionController（每个关节一个）**
- joint_name：关节名称
- p_gain：默认为1.0，但我们将设置为5.0（第1个关节）和3.0（第2个关节）

要使plugins工作，请用Gazebo启动机器人，然后用ROS 2桥接话题（在gazebo_bridge.yaml中）。然后，要测试plugins，找到相应的话题并在终端中创建一些发布者。

## 入门提示

以下是一些帮助你完成项目的额外提示：

- 对于机械臂，你可以创建一个新的URDF文件"arm.xacro"，和一个"standalone_arm.urdf.xacro"。在独立文件中，你包含"arm.xacro"和"common_properties.xacro"。通过这样做，你将能够单独测试机械臂，然后再将其附加到移动底座上。

- 要正确测试机械臂，将arm_base_link的质量设置为5.0kg而不是0.5kg，然后当你将两个机器人组合在一起时可以改回来。

- 以小步迭代的方式工作：首先编写带有links（仅视觉）和joints的URDF。然后，一旦你知道它是正确的，添加碰撞和惯性。再次测试，然后添加gazebo材质。测试，添加一个gazebo plugin，测试，等等。

- 你不需要重新创建任何launch文件，你可以只使用我们之前编写的那些并修改URDF文件路径。

- 如果你需要复习，不要犹豫回到这门课程的任何之前的课程。

## 项目步骤

如果你不知道从哪里开始，如果你想在一个步骤上工作+观看解决方案+进行下一步，那么这里是我将在视频中执行的步骤列表。

- **步骤1：** 创建新的arm.xacro和standalone_arm.urdf.xacro文件，编写links（仅视觉）、joints和材质。使用RViz逐步可视化你构建的内容。

- **步骤2：** 在links中添加碰撞和惯性标签。在joints中添加动力学标签。修改my_robot_bringup中现有的launch文件以使用standalone_arm.urdf.xacro。在Gazebo中启动机器人。

- **步骤3：** 添加JointStatePublisher gazebo plugin，以便为机械臂正确发布TFs（你可以在RViz上看到它们）。然后，添加JointPositionController plugin两次来控制机械臂的每个关节。启动Gazebo，找到要桥接的相关话题。完成后，从终端发送命令。

- **步骤4：** 将机械臂集成到my_robot.urdf.xacro文件中。在移动底座的base_link和机械臂的arm_base_link之间添加固定关节。使用my_robot_bringup中的launch文件在gazebo中启动和测试机器人。

如果你还在这里阅读，现在去项目上工作吧 :)