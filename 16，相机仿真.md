
### 1，创建相机的urdf
这里用简单的box来表示相机
![Pasted image 20251006135956.png](<attachments/Pasted image 20251006135956.png>)


### 2，加入相机插件
 
（1），在世界环境sdf里面加入一个传感器的插件
```xml
<plugin name='gz::sim::systems::Sensors' filename='gz-sim-sensors-system' >

<render_engine>ogre2</render_engine>

</plugin>
```

![Pasted image 20251006143433.png](<attachments/Pasted image 20251006143433.png>)

（2），加入相机插件部分
```xml
<!--关于gazebo插件中reference vs plugin 的区别-->
      <!-- reference="camera_link" 指定这个Gazebo配置应用到哪个link上 -->
      <!-- plugin 通常用于加载特定的Gazebo插件库 -->
      <gazebo reference="camera_link">
          <sensor name="camera" type="camera">
              <camera>
                  <horizontal_fov>1.3962634</horizontal_fov>  <!--水平视野角度 (1.3962634弧度 ≈ 80度)-->
                  <image> <!--图像参数-->
                      <width>640</width>  <!--图像分辨率 640x480-->
                      <height>480</height>
                      <format>R8G8B8</format> <!--颜色格式 R8G8B8 (RGB 8位)-->
                  </image>
                  <clip>  <!--渲染距离-->
                      <near>0.1</near>    <!--最近渲染距离 0.1米-->
                      <far>15</far>   <!--最远渲染距离 15米-->
                  </clip>
                  <noise>
                      <type>gaussian</type>
                      <mean>0.0</mean>
                      <stddev>0.007</stddev>
                  </noise>
                  <optical_frame_id>camera_link</optical_frame_id>
			                  <camera_info_topic>camera/camera_info</camera_info_topic> 
		                  <!--相机信息话题名-->
              </camera>
              <always_on>1</always_on>    <!--传感器始终开启-->
              <update_rate>20</update_rate>   <!--更新频率 20Hz-->
              <visualize>true</visualize> <!--在Gazebo中可视化-->
              <topic>camera/image_raw</topic> <!--图像数据发布话题名-->
          </sensor>
      </gazebo>
```

大部分内容都是相机的属性设置，注意的是，一开始的reference和后面的optical_frame_id，这里必须选相机的物理link名字！！

![Pasted image 20251006144437.png](<attachments/Pasted image 20251006144437.png>)

（3），到这里，在gazebo端已经有对应话题了
![Pasted image 20251006144515.png](<attachments/Pasted image 20251006144515.png>)
但是ros侧还没有，所以需要在bridge里面加入传输这两个量
![Pasted image 20251006144545.png](<attachments/Pasted image 20251006144545.png>)
详见[[15，gazebo]]

（4），到这里就可以了，在rviz里面开启camera，然后选中话题，就可以看到相机的画面了
![Pasted image 20251006144833.png](<attachments/Pasted image 20251006144833.png>)
![Pasted image 20251006144911.png](<attachments/Pasted image 20251006144911.png>)


### 3，传统相机的定义是z轴朝前，所以我们加入一个虚拟的转换link和joint用来转换坐标系！
```xml
<link name="camera_link_optical" />

  

<joint name="camera_optical_joint" type="fixed">

<origin xyz="0 0 0" rpy="${-pi/2} 0 ${-pi/2}"/>

<parent link="camera_link"/>

<child link="camera_link_optical"/>

</joint>
```

![Pasted image 20251006150239.png](<attachments/Pasted image 20251006150239.png>)

然后注意，底下这个optical_frame_id，也要改成转换后的坐标系（注意一开始的reference还是保持不变！要不然图像会翻转！这也是为什么不直接改camera_joint，而是要引入一个虚拟的转换坐标系）
![Pasted image 20251006150341.png](<attachments/Pasted image 20251006150341.png>)